<!DOCTYPE html>
<html lang="en">
<head>
	<link
		rel="icon"
		type="image/png"
		sizes="32x32"
		href="https://www.lolaelo.com/logo2.png?cb=favicon-32"
	/>
	<link
		rel="icon"
		type="image/png"
		sizes="16x16"
		href="https://www.lolaelo.com/logo2.png?cb=favicon-16"
	/>
	<link
		rel="shortcut icon"
		href="https://www.lolaelo.com/logo2.png?cb=favicon"
	/>
  <meta charset="UTF-8" />
  <title>Lolaelo - Checkout</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
    rel="stylesheet"
  />
<style>
  :root {
    --bg: #f9fafb;
    --card-bg: #ffffff;
    --border: #e5e7eb;
    --text: #0f172a;
    --muted: #6b7280;
    --accent: #ff6a3d;
    --accent-soft: rgba(255, 106, 61, 0.08);
    --teal: #0f766e;
    --radius-lg: 16px;
    --shadow-soft: 0 12px 30px rgba(15, 23, 42, 0.08);
  }

  * { box-sizing: border-box; }

  body {
    margin: 0;
    padding: 0;
    font-family: "Inter", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    background: var(--bg);
    color: var(--text);
  }

  /* ANCHOR: LAYOUT_SHELL */
  .page {
    min-height: 100vh;
    display: flex;
    flex-direction: column;
  }

  header {
    padding: 16px 24px;
    border-bottom: 1px solid var(--border);
    background: #ffffff;
    position: sticky;
    top: 0;
    z-index: 20;
  }

  .header-inner {
    max-width: 1040px;
    margin: 0 auto;
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 12px;
  }

  .logo {
    display: inline-flex;
    align-items: center;
    gap: 10px;
    font-weight: 700;
    letter-spacing: 0.06em;
    font-size: 18px;
  }

  .logo img {
    height: 24px; /* smaller header logo */
    display: block;
  }

  .logo-text {
    color: var(--accent);
    font-size: 14px;
    font-weight: 600;
    letter-spacing: 0.12em;
  }

  .step-indicator {
    font-size: 13px;
    color: var(--muted);
  }

  main {
    flex: 1;
    padding: 24px 16px 32px;
  }

  .layout {
    max-width: 1040px;
    margin: 0 auto;
    display: grid;
    grid-template-columns: minmax(0, 2.2fr) minmax(0, 1.1fr);
    gap: 24px;
    align-items: flex-start;
  }

  @media (max-width: 900px) {
    .layout {
      grid-template-columns: minmax(0, 1fr);
    }
  }

  /* ANCHOR: CARD_FRAME */
  .card {
    background: var(--card-bg);
    border-radius: var(--radius-lg);
    box-shadow: var(--shadow-soft);
    padding: 20px 20px 18px;
    border: 1px solid rgba(15, 23, 42, 0.02);
  }

  .card-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 10px;
    margin-bottom: 10px;
    cursor: pointer;
  }

  .card-title {
    font-size: 15px;
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 8px;
  }

  .card-step {
    width: 22px;
    height: 22px;
    border-radius: 999px;
    border: 1px solid var(--border);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 12px;
    font-weight: 500;
    color: var(--muted);
  }

  .card-step.active {
    border-color: var(--accent);
    background: var(--accent-soft);
    color: var(--accent);
  }

  .card-step.completed {
    border-color: var(--teal);
    background: rgba(16, 185, 129, 0.08);
    color: var(--teal);
  }

  .card-status {
    font-size: 12px;
    color: var(--muted);
  }

  .card-status.completed {
    color: var(--teal);
    font-weight: 500;
  }

  .section-body {
    margin-top: 6px;
    font-size: 14px;
    color: var(--muted);
  }

  .section-body.hidden {
    display: none;
  }

  /* ANCHOR: FIELDS_AND_FORM */
  .field-row {
    margin-top: 12px;
    display: flex;
    flex-direction: column;
    gap: 4px;
  }

  .field-label {
    font-size: 13px;
    color: var(--muted);
  }

  .field-value {
    font-size: 14px;
    color: var(--text);
  }

  .addons-block {
    margin-top: 16px;
    padding-top: 12px;
    border-top: 1px dashed var(--border-soft);
  }

  .addons-header {
    margin-bottom: 6px;
  }

  .addons-title {
    font-size: 14px;
    font-weight: 500;
  }

  .addons-subtitle {
    font-size: 12px;
    color: var(--muted);
  }

  .addons-list {
    display: flex;
    flex-direction: column;
    gap: 8px;
    margin-top: 4px;
  }

  .addon-row {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 8px;
    font-size: 13px;
  }

  .addon-main {
    display: flex;
    flex-direction: column;
  }

  .addon-title {
    font-weight: 500;
  }

  .addon-meta {
    font-size: 12px;
    color: var(--muted);
  }

  .addon-qty {
    display: flex;
    align-items: center;
    gap: 6px;
  }

  .addon-qty label {
    font-size: 12px;
    color: var(--muted);
  }

  .addon-qty input {
    width: 64px;
    padding: 4px 6px;
    border-radius: 6px;
    border: 1px solid var(--border-soft);
    text-align: right;
    font-size: 13px;
  }

  button {
    font-family: inherit;
    border: none;
    cursor: pointer;
  }

  .btn-primary {
    margin-top: 14px;
    padding: 9px 16px;
    border-radius: 999px;
    background: var(--accent);
    color: #ffffff;
    font-size: 14px;
    font-weight: 500;
    display: inline-flex;
    align-items: center;
    gap: 6px;
  }

  .btn-primary[disabled] {
    opacity: 0.6;
    cursor: default;
  }

  .btn-link {
    background: none;
    border: none;
    color: var(--teal);
    font-size: 13px;
    padding: 0;
  }

  .guest-form-grid {
    display: grid;
    grid-template-columns: repeat(2, minmax(0, 1fr));
    gap: 10px 12px;
    margin-top: 8px;
  }

  @media (max-width: 600px) {
    .guest-form-grid {
      grid-template-columns: minmax(0, 1fr);
    }
  }

  label {
    display: block;
    font-size: 13px;
    color: var(--muted);
    margin-bottom: 4px;
  }

  input,
  textarea {
    width: 100%;
    border-radius: 10px;
    border: 1px solid var(--border);
    padding: 8px 10px;
    font-size: 14px;
    font-family: inherit;
    outline: none;
    background: #ffffff;
  }

  input:focus,
  textarea:focus {
    border-color: var(--teal);
    box-shadow: 0 0 0 1px rgba(15, 118, 110, 0.12);
  }

  .phone-row {
    display: flex;
    gap: 8px;
    align-items: center;
  }

  .phone-country {
    min-width: 170px;
    border-radius: 10px;
    border: 1px solid var(--border);
    padding: 8px 8px;
    font-size: 13px;
    background: #ffffff;
  }

  .phone-country:focus {
    border-color: var(--teal);
    box-shadow: 0 0 0 1px rgba(15, 118, 110, 0.12);
    outline: none;
  }

  .phone-input {
    flex: 1;
  }

  textarea {
    min-height: 70px;
    resize: vertical;
  }

  .error-text {
    color: #b91c1c;
    font-size: 13px;
    margin-top: 6px;
  }

  /* ANCHOR: SUMMARY_CARD */
  .summary-card-title {
    font-size: 15px;
    font-weight: 600;
    margin-bottom: 6px;
  }

  .summary-line {
    display: flex;
    justify-content: space-between;
    align-items: baseline;
    font-size: 13px;
    margin-top: 4px;
    color: var(--muted);
  }

  .summary-line strong {
    font-size: 14px;
    color: var(--text);
  }

  .summary-total {
    margin-top: 10px;
    padding-top: 8px;
    border-top: 1px dashed var(--border);
    display: flex;
    justify-content: space-between;
    align-items: baseline;
  }

  .summary-total-label {
    font-size: 13px;
    color: var(--muted);
  }

  .summary-total-amount {
    font-size: 18px;
    font-weight: 600;
    color: var(--text);
  }

  .breakdown-toggle {
    margin-top: 8px;
    font-size: 13px;
    color: var(--teal);
    cursor: pointer;
  }

  .breakdown {
    margin-top: 6px;
    padding: 8px 0 4px;
    border-top: 1px dashed var(--border);
    display: none;
    font-size: 12px;
    color: var(--muted);
  }

  .breakdown.visible {
    display: block;
  }

  /* ANCHOR: STICKY_FOOTER */
  .sticky-footer {
    position: sticky;
    bottom: 0;
    margin-top: 16px;
    background: linear-gradient(
      to top,
      rgba(249, 250, 251, 0.96),
      rgba(249, 250, 251, 0.9)
    );
    padding-top: 8px;
  }

  .sticky-inner {
    max-width: 1040px;
    margin: 0 auto;
    padding: 10px 0 6px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 12px;
  }

  .sticky-label {
    font-size: 13px;
    color: var(--muted);
  }

  .sticky-amount {
    font-size: 16px;
    font-weight: 600;
    color: var(--text);
  }

  .sticky-button {
    padding: 11px 24px;
    border-radius: 999px;
    background: var(--accent);
    color: #ffffff;
    font-size: 14px;
    font-weight: 600;
    border: none;
    white-space: nowrap;
    margin-left: -65px; /* shift button ~10 characters to the left */
  }

  .sticky-button[disabled] {
    opacity: 0.6;
    cursor: default;
  }

  /* ANCHOR: PAYMENT_PILLS */
  .card-logos {
    display: inline-flex;
    align-items: center;
    justify-content: center;
  }

	/* BIGGER logos â€“ ~5x original */
	.card-logos img,
	.pill img,
	.card-logo-ticker {
		height: 60px;
		display: block;
		object-fit: contain;
	}

  /* Tidy spacing between the three payment pills */
  .payment-options-row {
    gap: 16px;
  }

  .pill-wrap {
    position: relative;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 6px;
    min-width: 190px;
  }

  .pill-caption {
    font-size: 11px;
    color: var(--muted);
    text-align: center;
    line-height: 1.3;
    margin-bottom: 2px; /* caption ABOVE the pill */
  }

  .pill {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 16px 22px;
    border-radius: 999px;
    font-size: 11px;
    font-weight: 500;
    border: 1px solid var(--border);
    color: var(--muted);
    background: #f9fafb;
    gap: 10px;
    transition:
      border-color 0.16s ease-out,
      box-shadow 0.16s ease-out,
      background 0.16s ease-out,
      transform 0.12s ease-out;
  }

  .pill-main {
    display: flex;
    align-items: center;
    gap: 10px;
  }

  /* Invisible radio that sits over the pill */
  .payment-pill-input {
    position: absolute;
    inset: 20px 0 0 0; /* start roughly at top of pill */
    opacity: 0;
    cursor: pointer;
  }

  /* Selected pill: orange outline + soft gradient */
  .payment-pill-input:checked + .pill {
    border-color: var(--accent);
    box-shadow: 0 0 0 2px rgba(255, 106, 61, 0.35);
    background: linear-gradient(135deg, rgba(255, 247, 237, 1), #ffffff);
    transform: translateY(-1px);
  }

  /* Remove old colored dot entirely */
  .pill-dot {
    display: none;
  }

  /* ANCHOR: SECURITY_HELPER */
  .payment-security {
    margin-top: 10px;
    display: flex;
    justify-content: flex-end;
    position: relative;
  }

  /* circular icon version â€“ used with the badge-style helper */
  .security-badge {
    width: 32px;
    height: 32px;
    border-radius: 999px;
    background: #dbeafe;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #0f766e;
    font-size: 16px;
    box-shadow: 0 8px 20px rgba(15, 23, 42, 0.15);
    cursor: default;
  }

  .security-icon-btn {
    width: 32px;
    height: 32px;
    border-radius: 999px;
    border: none;
    background: #e0f2fe;
    color: #0f766e;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 6px 16px rgba(15, 23, 42, 0.18);
    font-size: 16px;
    cursor: pointer;
  }

  .security-icon-btn:focus-visible {
    outline: 2px solid #0f766e;
    outline-offset: 2px;
  }

  .security-bubble {
    position: absolute;
    top: 130%;                     /* push BELOW the icon */
    left: 50%;                     /* center horizontally */
    transform: translate(-50%, 4px); /* center + slight slide on show */
    background: #e0fdf4;
    color: #0f172a;
    padding: 10px 12px;
    border-radius: 12px;
    width: 260px;
    box-shadow: 0 16px 35px rgba(15, 23, 42, 0.2);
    font-size: 12px;
    line-height: 1.4;
    opacity: 0;
    pointer-events: none;
    transition:
      opacity 0.18s ease-out,
      transform 0.18s ease-out;
    z-index: 30;
  }

  .security-bubble strong {
    color: #0f172a;   /* match bubble body text */
    font-weight: 700;
    display: block;
    margin-bottom: 6px;
  }

  .payment-security:hover .security-bubble,
  .payment-security:focus-within .security-bubble {
    opacity: 1;
    pointer-events: auto;
    transform: translateY(0);
  }

</style>

</head>
<body>
  <div class="page">
		<header>
			<div class="checkout-header-wrapper" style="
				display:flex;
				align-items:center;
				justify-content:space-between;
				padding:16px 24px;
				border-bottom:1px solid var(--border);
				background:#ffffff;
			">
				
				<!-- LEFT: LOGO -->
				<div style="display:flex;align-items:center;gap:10px;">
					<a href="https://www.lolaelo.com/">
						<img
							src="https://www.lolaelo.com/logo.png?cb=logo-5x"
							alt="Lolaelo"
							decoding="async"
							loading="eager"
							style="display:block;height:24px;width:auto;"
						>
					</a>
				</div>

				<!-- CENTER: CHECKOUT TITLE -->
				<div style="
					flex:1;
					display:flex;
					justify-content:center;
					pointer-events:none;
					margin-left:-48px; /* counter logo width for true center */
				">
					<span style="
						font-size:20px;
						font-weight:600;
						color:#ff6a3d;
						letter-spacing:0.4px;
					">
						CHECKOUT
					</span>
				</div>

				<!-- RIGHT: STEP INDICATOR -->
				<div class="step-indicator" style="font-size:13px;color:var(--muted);white-space:nowrap;">
					Step 1 of 2 Â· Review and details
				</div>

			</div>
		</header>
    <main>
      <div class="layout">
        <!-- Left side: progressive sections -->
        <div>
          <!-- Section 1 - Property and room -->
          <div class="card" data-section="1">
            <div class="card-header">
              <div class="card-title">
                <div class="card-step active" data-step-indicator="1">1</div>
                Property and room
              </div>
              <div class="card-status" data-step-status="1">
                Waiting for confirmation
              </div>
            </div>
            <div class="section-body" data-section-body="1">
            <div class="field-row">
              <div class="field-label">Property name</div>
              <div class="field-value">
                <div id="propertyName"></div>
                <div class="muted" id="propertyMeta"></div>
                <span id="propertyIdValue" style="display:none;"></span>
              </div>
            </div>
              <div class="field-row">
                <div class="field-label">Room</div>
                <div class="field-value">
                  <div id="roomName"></div>
                  <span id="roomIdValue" style="display:none;"></span>
                </div>
              </div>
              <div class="field-row">
                <div class="field-label">Rate plan</div>
                <div class="field-value">
                  <div id="ratePlanName"></div>
                  <span id="ratePlanIdValue" style="display:none;"></span>
                </div>
              </div>
              <div class="field-inline">
                <button class="btn-link" id="changePlanLink" type="button">
                  Change room or rate plan
                </button>
              </div>
              <button class="btn-primary" type="button" data-confirm="1">
                Confirm room
              </button>
            </div>
          </div>

<!-- Section 2 - Dates and pricing -->
          <div class="card" data-section="2">
            <div class="card-header">
              <div class="card-title">
                <div class="card-step" data-step-indicator="2">2</div>
                Dates and pricing
              </div>
              <div class="card-status" data-step-status="2">
                Locked until previous step
              </div>
            </div>
            <div class="section-body hidden" data-section-body="2">
              <div class="field-row">
                <div class="field-label">Stay dates</div>
                <div class="field-value" id="stayDatesText">Dates from URL</div>
              </div>

              <div class="field-row">
                <div class="field-label">Nights</div>
                <div class="field-value" id="nightsCountText">n nights</div>
              </div>

              <div class="field-inline">
                <button class="btn-link" id="editDatesLink" type="button">
                  Edit dates
                </button>
              </div>

              <button class="btn-primary" type="button" data-confirm="2">
                Confirm dates and price
              </button>
            </div>
          </div>

          <!-- Section 3 - Add-ons -->
          <div class="card" data-section="3">
            <div class="card-header">
              <div class="card-title">
                <div class="card-step" data-step-indicator="3">3</div>
                Add-ons
              </div>
              <div class="card-status" data-step-status="3">
                Locked until previous step
              </div>
            </div>
            <div class="section-body hidden" data-section-body="3">
              <!-- Add-ons block (traveler view; data to be wired in next steps) -->
              <div class="addons-block">
                <div class="addons-header">
                  <div class="addons-title">Add-ons</div>
                  <div class="addons-subtitle">
                    Optional activities and extras selected by your hotel.
                  </div>
                </div>
                <div id="addonsList" class="addons-list">
                  <div class="muted" id="addonsEmptyMessage">
                    No add-ons are available for this stay.
                  </div>
                </div>
              </div>

              <button class="btn-primary" type="button" data-confirm="3">
                Confirm add-ons
              </button>
            </div>
          </div>

          <!-- Section 4 - Guest details -->
          <div class="card" data-section="4">
            <div class="card-header">
              <div class="card-title">
                <div class="card-step" data-step-indicator="4">4</div>
                Guest details
              </div>
              <div class="card-status" data-step-status="4">
                Locked until previous step
              </div>
            </div>
            <div class="section-body hidden" data-section-body="4">
              <div class="guest-form-grid">
                <div>
                  <label for="firstName">First name</label>
                  <input id="firstName" autocomplete="given-name" />
                </div>
                <div>
                  <label for="lastName">Last name</label>
                  <input id="lastName" autocomplete="family-name" />
                </div>
                <div>
                  <label for="email">Email</label>
                  <input id="email" type="email" autocomplete="email" />
                </div>
                <div>
                  <label for="phone">Mobile number</label>
                  <div class="phone-row">
                    <select id="phoneCountry" class="phone-country">
                      <option value="+1">ðŸ‡ºðŸ‡¸ +1 (United States)</option>
                      <option value="+63">ðŸ‡µðŸ‡­ +63 (Philippines)</option>
                      <option value="+44">+44 (United Kingdom)</option>
                      <option value="+61">+61 (Australia)</option>
                      <option value="+65">+65 (Singapore)</option>
                      <option value="+81">+81 (Japan)</option>
                      <option value="+82">+82 (South Korea)</option>
                      <option value="+49">+49 (Germany)</option>
                      <option value="+33">+33 (France)</option>
                      <option value="+34">+34 (Spain)</option>
                      <option value="+39">+39 (Italy)</option>
                      <option value="+31">+31 (Netherlands)</option>
                      <option value="+63-other">Other</option>
                    </select>
                    <input
                      id="phone"
                      type="tel"
                      autocomplete="tel"
                      placeholder="9-digit mobile"
                      class="phone-input"
                    />
                  </div>
                </div>
              </div>

              <div style="margin-top: 10px;">
                <label for="specialRequests">
                  Special request to hotel management (optional)
                </label>
                <textarea id="specialRequests"></textarea>
              </div>

              <div class="error-text" id="guestError" style="display: none;">
                Please fill in all guest details and contact information.
              </div>

              <button class="btn-primary" type="button" data-confirm="4">
                Confirm guest details
              </button>
            </div>
          </div>

          <!-- Section 5 - Payment method -->
          <div class="card" data-section="5">
            <div class="card-header">
              <div class="card-title">
                <div class="card-step" data-step-indicator="5">5</div>
                Payment method
              </div>
              <div class="card-status" data-step-status="4">
                Locked until previous step
              </div>
            </div>

            <div class="section-body hidden" data-section-body="4">
              <div class="field-row">

                <!-- TOP ROW: PAYMENT PILLS -->
                <div class="field-inline payment-options-row">
                  <!-- CARD / STRIPE -->
                  <div class="pill-wrap">
                    <div class="pill-caption">
                      Stripe â€“ Major CCs
                    </div>
                    <label class="pill-wrap-label">
                      <input
                        type="radio"
                        name="paymentMethod"
                        value="card"
                        class="payment-pill-input"
                        checked
                      />
                      <div class="pill">
                        <div class="pill-main">
                          <div class="card-logos">
														<img
															src="https://www.lolaelo.com/assets/card_visa.png"
															alt="Visa, Mastercard, Apple Pay, Discover, Amex"
															class="card-logo-ticker"
														/>
                          </div>
                        </div>
                      </div>
                    </label>
                  </div>

                  <!-- PAYPAL -->
                  <div class="pill-wrap">
                    <div class="pill-caption">
                      (coming soon)
                    </div>
                    <label class="pill-wrap-label">
                      <input
                        type="radio"
                        name="paymentMethod"
                        value="paypal"
                        class="payment-pill-input"
                        disabled
                      />
                      <div class="pill">
                        <div class="pill-main">
                          <img
                            src="https://www.lolaelo.com/assets/paypal.png"
                            alt="PayPal"
                          >
                        </div>
                      </div>
                    </label>
                  </div>

                  <!-- GCASH -->
                  <div class="pill-wrap">
                    <div class="pill-caption">
                      (coming soon)
                    </div>
                    <label class="pill-wrap-label">
                      <input
                        type="radio"
                        name="paymentMethod"
                        value="gcash"
                        class="payment-pill-input"
                        disabled
                      />
                      <div class="pill">
                        <div class="pill-main">
                          <img
                            src="https://www.lolaelo.com/assets/gcash.png"
                            alt="GCash"
                          >
                        </div>
                      </div>
                    </label>
                  </div>
                </div>

                <!-- BOTTOM ROW: TEXT CAPTIONS UNDER PILLS -->
                <div class="field-inline payment-options-row" style="margin-top: 6px;">
                  <div style="min-width:190px;text-align:center;font-size:12px;color:#6b7280;">
                    <div>Visa â€“ MasterCard â€“ AMEX</div>
                    <div>ApplePay â€“ Discover</div>
                  </div>
                  <div style="min-width:190px;text-align:center;font-size:12px;color:#6b7280;">
                    PayPal
                  </div>
                  <div style="min-width:190px;text-align:center;font-size:12px;color:#6b7280;">
                    GCash
                  </div>
                </div>
              </div>

							<!-- SECURITY ICON + CONFIRM BUTTON (SIDE BY SIDE) -->
							<div style="display:flex; align-items:center; justify-content:flex-start; gap:14px; margin-top:16px; position:relative;">

                <!-- Confirm button -->
                <button class="btn-primary" type="button" data-confirm="5">
                  Proceed to secure payment
                </button>

								<!-- Security icon + bubble -->
								<div class="payment-security" style="position:relative;">
									<button
										class="security-icon-btn"
										type="button"
										aria-label="Security and payments"
									>
										ðŸ”’
									</button>

									<div class="security-bubble">
										<strong>Secure checkout</strong>
										Your payment is encrypted and processed by Stripe, the same
										provider trusted by companies like Lyft and Airbnb.
										Future options like PayPal and GCash will follow the same
										security standards so your card details never touch our servers.
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>

				<!-- Right side: booking summary -->
        <aside>

          <div class="card">
            <div class="summary-card-title">Your stay</div>

            <div class="summary-line">
              <span>Property name</span>
              <strong id="summaryProperty">Property</strong>
            </div>

            <div class="summary-line">
              <span>Room type</span>
              <strong id="summaryRoom">Room</strong>
            </div>

            <div class="summary-line">
              <span>Rate plan</span>
              <strong id="summaryPlan">Rate plan</strong>
            </div>

            <div class="summary-line">
              <span>Dates</span>
              <strong id="summaryDates">Dates</strong>
            </div>

            <div class="summary-line">
              <span>Nights</span>
              <strong id="summaryNights">n</strong>
            </div>

            <div class="summary-line">
              <span>Add-ons</span>
              <strong id="summaryAddons">None selected</strong>
            </div>

            <div class="summary-total">
              <div>
                <div class="summary-total-label">Total</div>
              </div>
              <div class="summary-total-amount" id="summaryTotal">
                $50.00
              </div>
            </div>

            <div class="breakdown-toggle" id="breakdownToggle">
              View nightly breakdown
            </div>
            <div class="breakdown" id="breakdownDetails">
            </div>

          </div>

        </aside>

      <div class="sticky-footer">
        <div class="sticky-inner">
          <div>

          </div>
            <button class="sticky-button" id="confirmAndPayButton" disabled>
              Proceed to secure payment
            </button>
        </div>
      </div>
    </main>
  </div>

  <script>
    function parseQuery() {
      const params = new URLSearchParams(window.location.search);

      return {
        propertyId: params.get("propertyId") || "",
        roomId: params.get("roomId") || "",
        start: params.get("start") || "",
        end: params.get("end") || "",

        // IDs
        ratePlanId: params.get("ratePlanId") || params.get("plan") || "",

        // Optional name fields (can be populated from catalog_details)
        propertyName: params.get("propertyName") || "",
        propertyLocation: params.get("propertyLocation") || "",
        roomName: params.get("roomName") || "",

        // Rate plan display name â€“ prefer explicit name, fall back to planLabel
        ratePlanName:
          params.get("ratePlanName") ||
          params.get("planLabel") ||
          ""
      };
    }

    function formatDate(dateStr) {
      if (!dateStr) return "";
      const dt = new Date(dateStr);
      if (Number.isNaN(dt.getTime())) return dateStr;
      return dt.toLocaleDateString(undefined, {
        month: "short",
        day: "numeric",
        year: "numeric"
      });
    }

    function diffNights(startStr, endStr) {
      if (!startStr || !endStr) return "";
      const s = new Date(startStr);
      const e = new Date(endStr);
      if (Number.isNaN(s.getTime()) || Number.isNaN(e.getTime())) return "";
      const ms = e.getTime() - s.getTime();
      const nights = Math.round(ms / (1000 * 60 * 60 * 24));
      return nights > 0 ? nights : "";
    }

    function renderAddons(addons) {
      const listEl = document.getElementById("addonsList");
      const emptyEl = document.getElementById("addonsEmptyMessage");
      if (!listEl) return;

      listEl.innerHTML = "";

      const rows = Array.isArray(addons) ? addons : [];
      if (!rows.length) {
        if (emptyEl) {
          emptyEl.textContent = "No add-ons are available for this stay.";
          listEl.appendChild(emptyEl);
        }
        return;
      }

      // header row
      const header = document.createElement("div");
      header.className = "addon-row";
      header.style.fontWeight = "600";

      const hMain = document.createElement("div");
      hMain.className = "addon-main";
      const hTitle = document.createElement("div");
      hTitle.className = "addon-title";
      hTitle.textContent = "Activity";
      const hMeta = document.createElement("div");
      hMeta.className = "addon-meta";
      hMeta.textContent = "Price Â· Unit Â· Hotel notes";
      hMain.appendChild(hTitle);
      hMain.appendChild(hMeta);

      const hQty = document.createElement("div");
      hQty.className = "addon-qty";
      const hQtyLabel = document.createElement("span");
      hQtyLabel.textContent = "Qty";
      hQty.appendChild(hQtyLabel);

      header.appendChild(hMain);
      header.appendChild(hQty);

      listEl.appendChild(header);

      rows.forEach(function (item, idx) {
        const activity = (item.activity || "").toString().trim() || "Add-on";
        const uom = (item.uom || "").toString().trim();
        const rawPrice = item.price;
        const notes = (item.notes || "").toString().trim();

        const price =
          typeof rawPrice === "number"
            ? rawPrice
            : (rawPrice != null ? Number(rawPrice) : NaN);

        let priceText = "";
        if (!Number.isNaN(price) && Number.isFinite(price)) {
          try {
            priceText = price.toLocaleString(undefined, {
              style: "currency",
              currency: "USD"
            });
          } catch (e) {
            priceText = "$" + price.toFixed(2);
          }
        }

        const metaParts = [];
        if (priceText) metaParts.push(priceText);
        if (uom) metaParts.push(uom);
        if (notes) metaParts.push(notes);
        const metaText = metaParts.join(" Â· ");

        const row = document.createElement("div");
        row.className = "addon-row";

        const main = document.createElement("div");
        main.className = "addon-main";

        const titleEl = document.createElement("div");
        titleEl.className = "addon-title";
        titleEl.textContent = activity;

        const metaEl = document.createElement("div");
        metaEl.className = "addon-meta";
        metaEl.textContent = metaText;

        main.appendChild(titleEl);
        main.appendChild(metaEl);

        const qtyWrap = document.createElement("div");
        qtyWrap.className = "addon-qty";

        const qtyLabel = document.createElement("label");
        qtyLabel.textContent = "Qty";

        const qtyInput = document.createElement("input");
        qtyInput.type = "number";
        qtyInput.min = "0";
        qtyInput.step = "1";
        qtyInput.value = "0";
        qtyInput.setAttribute("data-addon-index", String(idx));

        qtyWrap.appendChild(qtyLabel);
        qtyWrap.appendChild(qtyInput);

        row.appendChild(main);
        row.appendChild(qtyWrap);

        // Traveler comment field under each row
        const comment = document.createElement("textarea");
        comment.rows = 2;
        comment.placeholder = "Comments for hotel (optional)";
        comment.className = "addon-comment";
        comment.setAttribute("data-addon-index", String(idx));

        const wrapper = document.createElement("div");
        wrapper.style.display = "flex";
        wrapper.style.flexDirection = "column";
        wrapper.style.gap = "4px";

        wrapper.appendChild(row);
        wrapper.appendChild(comment);

        listEl.appendChild(wrapper);
      });
    }

    async function loadAddonsForProperty() {
      if (!state.propertyId) return;

      try {
        const params = new URLSearchParams();
        params.set("propertyId", state.propertyId);
        if (state.start) params.set("start", state.start);
        if (state.end) params.set("end", state.end);

        const resp = await fetch("/catalog/details?" + params.toString(), {
          method: "GET",
          headers: { Accept: "application/json" }
        });

        if (!resp.ok) {
          throw new Error("Failed to load add-ons for property " + state.propertyId);
        }

        const data = await resp.json();
        const addons = Array.isArray(data.addons) ? data.addons : [];
        state.addonsConfig = addons;
        renderAddons(addons);
      } catch (err) {
        console.error("Error loading add-ons", err);
        state.addonsConfig = [];
        renderAddons([]);
      }
    }

    function recomputeSelectedAddons() {
      const listEl = document.getElementById("addonsList");
      if (!listEl) return;

      const qtyInputs = listEl.querySelectorAll(
        'input[type="number"][data-addon-index]'
      );
      const commentAreas = listEl.querySelectorAll(
        'textarea.addon-comment[data-addon-index]'
      );

      const commentsByIndex = {};
      commentAreas.forEach(function (ta) {
        const idxAttr = ta.getAttribute("data-addon-index");
        const idx = Number(idxAttr);
        if (!Number.isFinite(idx) || idx < 0) return;
        commentsByIndex[idx] = ta.value || "";
      });

      const selections = [];

      qtyInputs.forEach(function (input) {
        const idxAttr = input.getAttribute("data-addon-index");
        const idx = Number(idxAttr);
        if (!Number.isFinite(idx) || idx < 0) return;

        const qty = Number(input.value || "0");
        if (!Number.isFinite(qty) || qty <= 0) return;

        const cfg = Array.isArray(state.addonsConfig)
          ? state.addonsConfig[idx]
          : null;
        if (!cfg) return;

        const rawPrice = cfg.price;
        const price =
          typeof rawPrice === "number"
            ? rawPrice
            : (rawPrice != null ? Number(rawPrice) : NaN);

        const lineTotal =
          !Number.isNaN(price) && Number.isFinite(price)
            ? price * qty
            : null;

        selections.push({
          index: idx,
          quantity: qty,
          activity: (cfg.activity || "").toString().trim(),
          uom: (cfg.uom || "").toString().trim(),
          price: !Number.isNaN(price) && Number.isFinite(price) ? price : null,
          lineTotal,
          travelerComment: commentsByIndex[idx] || ""
        });
      });

      state.selectedAddons = selections;
      updateSummaries();
    }

    const state = {
      propertyId: "",
      roomId: "",
      start: "",
      end: "",
      ratePlanId: "",
      propertyName: "",
      propertyLocation: "",
      roomName: "",
      ratePlanName: "",
      addonsConfig: [],
      selectedAddons: [],
      sectionConfirmed: { 1: false, 2: false, 3: false, 4: false }
    };

    function updateSummaries() {
      const propertyText =
        state.propertyName || state.propertyId || "Property";
      const propertyMeta = state.propertyLocation || "";
      const roomText =
        state.roomName || state.roomId || "Room";
      const planText =
        state.ratePlanName || state.ratePlanId || "Rate plan";

      // Hidden IDs (for debugging / future logic)
      const propIdEl = document.getElementById("propertyIdValue");
      if (propIdEl) propIdEl.textContent = state.propertyId;
      const roomIdEl = document.getElementById("roomIdValue");
      if (roomIdEl) roomIdEl.textContent = state.roomId;
      const planIdEl = document.getElementById("ratePlanIdValue");
      if (planIdEl) planIdEl.textContent = state.ratePlanId;

      // Visible labels in Section 1
      const propNameEl = document.getElementById("propertyName");
      if (propNameEl) propNameEl.textContent = propertyText;
      const propMetaEl = document.getElementById("propertyMeta");
      if (propMetaEl) propMetaEl.textContent = propertyMeta;

      const roomNameEl = document.getElementById("roomName");
      if (roomNameEl) roomNameEl.textContent = roomText;
      const planNameEl = document.getElementById("ratePlanName");
      if (planNameEl) planNameEl.textContent = planText;

      // Summary card on the right
      document.getElementById("summaryProperty").textContent = propertyText;
      document.getElementById("summaryRoom").textContent = roomText;
      document.getElementById("summaryPlan").textContent = planText;

      const startFormatted = formatDate(state.start);
      const endFormatted = formatDate(state.end);
      const nights = diffNights(state.start, state.end);
            const datesText =
        startFormatted && endFormatted
          ? startFormatted + " to " + endFormatted
          : "Dates";
      document.getElementById("stayDatesText").textContent = datesText;
      document.getElementById("summaryDates").textContent = datesText;
      const nightsText = nights ? nights + " night" + (nights > 1 ? "s" : "") : "";
      document.getElementById("nightsCountText").textContent = nightsText || "nights";
      document.getElementById("summaryNights").textContent = nightsText || "n";

      // Add-ons summary
      var addonsLabel = "None selected";
      if (Array.isArray(state.selectedAddons) && state.selectedAddons.length) {
        var totalQty = state.selectedAddons.reduce(function (sum, item) {
          var q = Number(item.quantity || 0);
          return sum + (Number.isFinite(q) && q > 0 ? q : 0);
        }, 0);
        if (totalQty > 0) {
          addonsLabel =
            totalQty +
            " add-on" +
            (totalQty === 1 ? "" : "s");
        }
      }
      var addonsEl = document.getElementById("summaryAddons");
      if (addonsEl) addonsEl.textContent = addonsLabel;
    }

    function setSectionState(section, status) {
      const stepCircle = document.querySelector('[data-step-indicator="' + section + '"]');
      const statusLabel = document.querySelector('[data-step-status="' + section + '"]');
      const body = document.querySelector('[data-section-body="' + section + '"]');
      if (!stepCircle || !statusLabel || !body) return;

      if (status === "active") {
        stepCircle.classList.add("active");
        stepCircle.classList.remove("completed");
        statusLabel.textContent = "Waiting for confirmation";
        statusLabel.classList.remove("completed");
        body.classList.remove("hidden");
      } else if (status === "completed") {
        stepCircle.classList.remove("active");
        stepCircle.classList.add("completed");
        statusLabel.textContent = "Confirmed";
        statusLabel.classList.add("completed");
        body.classList.add("hidden");
      } else {
        stepCircle.classList.remove("active");
        stepCircle.classList.remove("completed");
        statusLabel.textContent = "Locked until previous step";
        statusLabel.classList.remove("completed");
        body.classList.add("hidden");
      }
    }

    function refreshSections() {
      for (let i = 1; i <= 5; i++) {
        const isConfirmed = state.sectionConfirmed[i];
        if (i === 1) {
          setSectionState(1, isConfirmed ? "completed" : "active");
        } else {
          const prevDone = state.sectionConfirmed[i - 1];
          if (!prevDone) {
            setSectionState(i, "locked");
          } else {
            setSectionState(i, isConfirmed ? "completed" : "active");
          }
        }
      }
      const allConfirmed =
        state.sectionConfirmed[1] &&
        state.sectionConfirmed[2] &&
        state.sectionConfirmed[3] &&
        state.sectionConfirmed[4] &&
        state.sectionConfirmed[5];
      document.getElementById("confirmAndPayButton").disabled = !allConfirmed;
    }

    function handleConfirmClick(section) {
      if (section === 4) {
        const firstName = document.getElementById("firstName").value.trim();
        const lastName = document.getElementById("lastName").value.trim();
        const email = document.getElementById("email").value.trim();
        const phone = document.getElementById("phone").value.trim();
        const errorEl = document.getElementById("guestError");

        if (!firstName || !lastName || !email || !phone) {
          if (errorEl) errorEl.style.display = "block";
          return;
        } else if (errorEl) {
          errorEl.style.display = "none";
        }
      }

      state.sectionConfirmed[section] = true;
      refreshSections();
    }

    function initCheckout() {
      const q = parseQuery();
      state.propertyId = q.propertyId;
      state.roomId = q.roomId;
      state.start = q.start;
      state.end = q.end;
      state.ratePlanId = q.ratePlanId;
      state.propertyName = q.propertyName;
      state.propertyLocation = q.propertyLocation;
      state.roomName = q.roomName;
      state.ratePlanName = q.ratePlanName;

      updateSummaries();
      refreshSections();
      loadAddonsForProperty();

      // Allow clicking headers to reopen a section, but keep only one open

      // Allow clicking headers to reopen a section, but keep only one open
      document.querySelectorAll(".card-header").forEach(function (header) {
        header.addEventListener("click", function () {
          var card = header.closest(".card");
          if (!card) return;
          var section = Number(card.getAttribute("data-section"));
          if (!section) return;

          // Donâ€™t let user jump ahead if previous sections arenâ€™t confirmed
          for (var i = 1; i < section; i++) {
            if (!state.sectionConfirmed[i]) {
              return;
            }
          }

          // Open this section, close all others
          document.querySelectorAll("[data-section-body]").forEach(function (bodyEl) {
            var bodySection = Number(bodyEl.getAttribute("data-section-body"));
            if (bodySection === section) {
              bodyEl.classList.remove("hidden");
            } else {
              bodyEl.classList.add("hidden");
            }
          });
        });
      });

      document.querySelectorAll("[data-confirm]").forEach(function (btn) {
        btn.addEventListener("click", function () {
          const section = Number(btn.getAttribute("data-confirm"));
          handleConfirmClick(section);
        });
      });

      const breakdownToggle = document.getElementById("breakdownToggle");
      const breakdownDetails = document.getElementById("breakdownDetails");
      if (breakdownToggle && breakdownDetails) {
        breakdownToggle.addEventListener("click", function () {
          breakdownDetails.classList.toggle("visible");
        });
      }

      const confirmAndPayButton = document.getElementById("confirmAndPayButton");
      if (confirmAndPayButton) {
        confirmAndPayButton.addEventListener("click", async function () {
          if (confirmAndPayButton.disabled) return;

          confirmAndPayButton.disabled = true;
          confirmAndPayButton.textContent = "Redirecting to secure payment...";

          try {
            const response = await fetch("/api/payments/create-checkout-session", {
              method: "POST",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify({
                propertyId: state.propertyId,
                roomId: state.roomId,
                start: state.start,
                end: state.end,
                ratePlanId: state.ratePlanId,
                addons: Array.isArray(state.selectedAddons)
                  ? state.selectedAddons
                  : []
              })
            });

            if (!response.ok) throw new Error("Failed to start payment");
            const data = await response.json();
            if (data && data.url) {
              window.location.href = data.url;
            } else {
              throw new Error("Missing redirect URL");
            }
          } catch (err) {
            console.error("Error starting Stripe Checkout", err);
            confirmAndPayButton.disabled = false;
            confirmAndPayButton.textContent = "Proceed to secure payment";
            alert("Could not start payment. Please try again.");
          }
        });
      }

      const changePlanLink = document.getElementById("changePlanLink");
      if (changePlanLink) {
        changePlanLink.addEventListener("click", function () {
          window.history.back();
        });
      }

      const editDatesLink = document.getElementById("editDatesLink");
      if (editDatesLink) {
        editDatesLink.addEventListener("click", function () {
          window.history.back();
        });
      }
    }
    document.addEventListener("DOMContentLoaded", function () {
      initCheckout();

      const addonsList = document.getElementById("addonsList");
      if (addonsList) {
        addonsList.addEventListener("input", function (ev) {
          const target = ev.target;
          if (!target) return;

          const isQty =
            target.tagName === "INPUT" &&
            target.getAttribute("type") === "number" &&
            target.getAttribute("data-addon-index") != null;

          const isComment =
            target.tagName === "TEXTAREA" &&
            target.classList.contains("addon-comment") &&
            target.getAttribute("data-addon-index") != null;

          if (!isQty && !isComment) return;

          recomputeSelectedAddons();
        });
      }
    });
  </script>


	  <script>
    (function () {
      const tickerImg = document.querySelector(".card-logo-ticker");
      if (!tickerImg) return;

      // TODO: make sure these 5 files exist in /assets on lolaelo.com
      const logos = [
        "https://www.lolaelo.com/assets/card_visa.png",
        "https://www.lolaelo.com/assets/card_mastercard.png",
        "https://www.lolaelo.com/assets/card_applepay.png",
        "https://www.lolaelo.com/assets/card_discover.png",
        "https://www.lolaelo.com/assets/card_amex.png",
      ];

      let index = 0;
      setInterval(() => {
        index = (index + 1) % logos.length;
        tickerImg.src = logos[index];
      }, 1500);
    })();
  </script>

</body>
</html>
